class Solution:
    def validateCoupons(self, code: List[str], businessLine: List[str], isActive: List[bool]) -> List[str]:
        order = {
            "electronics": 0,
            "grocery": 1,
            "pharmacy": 2,
            "restaurant": 3
        }
        valid = []
        for c, b, a in zip(code, businessLine, isActive):
            if not a:
                continue
            if b not in order:
                continue
            if not c:
                continue
            for ch in c:
                if not (ch.isalnum() or ch == "_"):
                    break
            else:
                valid.append((order[b], c))
        valid.sort(key=lambda x: (x[0], x[1]))
        return [c for _, c in valid]
